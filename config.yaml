# Agentic RAG System Configuration
# Multimodal Edition

# System Settings
system:
  device: "cuda"  # cuda, cpu, mps
  seed: 42
  num_workers: 4
  batch_size: 32
  cache_dir: "./cache"
  data_dir: "./data"
  models_dir: "./models"
  indices_dir: "./indices"
  log_level: "INFO"
  enable_monitoring: true
  enable_caching: true

# Model Configuration
models:
  # Language Models
  language_model:
    name: "mistralai/Mistral-7B-Instruct-v0.2"
    quantization: "4bit"  # none, 4bit, 8bit
    max_length: 4096
    temperature: 0.7
    top_p: 0.9
    top_k: 50
    do_sample: true
    device_map: "auto"
    trust_remote_code: false
    
  # Embedding Models
  text_embedder:
    name: "sentence-transformers/all-MiniLM-L6-v2"
    dimension: 384
    max_seq_length: 512
    normalize: true
    
  # Vision-Language Models
  vision_language:
    clip_model: "openai/clip-vit-base-patch32"
    blip_model: "Salesforce/blip2-opt-2.7b"
    use_fp16: true
    image_size: 224
    
  # Audio Models
  audio:
    whisper_model: "openai/whisper-small"
    sample_rate: 16000
    chunk_length: 30
    
  # Reranking Models
  reranker:
    name: "cross-encoder/ms-marco-MiniLM-L-6-v2"
    enabled: true

# Retrieval Configuration
retrieval:
  # Chunking
  chunk_size: 512
  chunk_overlap: 50
  semantic_chunking:
    enabled: false
    similarity_threshold: 0.7
    
  # Search
  top_k: 5
  rerank_top_k: 3
  similarity_threshold: 0.5
  
  # Hybrid Search
  hybrid_search:
    enabled: true
    alpha: 0.5  # Weight for dense vs sparse
    use_bm25: true
    use_tfidf: false
    
  # Vector Store
  vector_store:
    type: "faiss"  # faiss, chromadb, qdrant, weaviate, pinecone
    index_type: "Flat"  # Flat, IVF, HNSW
    metric: "cosine"  # cosine, euclidean, dot_product
    
  # Graph Retrieval
  graph:
    enabled: false
    max_hops: 2
    edge_weight_threshold: 0.3

# Agent Configuration
agent:
  type: "reactive"  # reactive, planning, reflexive
  max_iterations: 5
  enable_reflection: true
  enable_self_critique: true
  chain_of_thought: true
  
  # Tools
  tools:
    enabled:
      - "retrieve"
      - "analyze_image"
      - "transcribe_audio"
      - "extract_video_frames"
      - "web_search"
      - "calculator"
      - "summarize"
      - "compare"
      - "translate"
      - "fact_check"
    
    web_search:
      engine: "duckduckgo"  # duckduckgo, google, bing
      max_results: 10
    
    calculator:
      precision: 10
      
    summarize:
      max_length: 200
      min_length: 50

# Multimodal Configuration
multimodal:
  # Modality Processing
  process_text: true
  process_images: true
  process_audio: true
  process_video: true
  
  # Cross-Modal Settings
  cross_modal_retrieval: true
  fusion_strategy: "weighted"  # weighted, concat, attention
  modality_weights:
    text: 0.4
    image: 0.3
    audio: 0.2
    video: 0.1
    
  # Image Processing
  images:
    formats: ["jpg", "jpeg", "png", "gif", "bmp", "webp", "tiff"]
    max_size: 10485760  # 10MB
    resize_large: true
    target_size: [224, 224]
    extract_text_ocr: true
    extract_features: true
    
  # Audio Processing
  audio:
    formats: ["mp3", "wav", "flac", "m4a", "ogg", "aac"]
    max_duration: 600  # 10 minutes
    transcribe: true
    extract_features: true
    denoise: true
    
  # Video Processing
  video:
    formats: ["mp4", "avi", "mov", "mkv", "webm"]
    max_size: 104857600  # 100MB
    frames_per_video: 8
    extract_audio: true
    extract_keyframes: true
    temporal_pooling: "mean"  # mean, max, attention
    
  # Document Processing
  documents:
    formats: ["pdf", "docx", "txt", "md", "html", "epub", "rtf"]
    extract_tables: true
    extract_images: true
    extract_metadata: true
    max_pages: 1000

# Performance Optimization
optimization:
  # Quantization
  use_quantization: true
  quantization_config:
    load_in_4bit: true
    bnb_4bit_compute_dtype: "float16"
    bnb_4bit_use_double_quant: true
    bnb_4bit_quant_type: "nf4"
    
  # Memory Management
  gradient_checkpointing: true
  cpu_offload: false
  disk_offload: false
  max_memory: 20  # GB
  
  # Batch Processing
  batch_size: 8
  gradient_accumulation_steps: 4
  mixed_precision: "fp16"  # no, fp16, bf16
  
  # Caching
  cache_embeddings: true
  cache_results: true
  cache_ttl: 3600  # seconds

# Storage Configuration
storage:
  # Paths
  data_path: "./data"
  index_path: "./indices"
  cache_path: "./cache"
  checkpoint_path: "./checkpoints"
  
  # Database
  database:
    type: "sqlite"  # sqlite, postgresql, mysql, mongodb
    connection_string: "sqlite:///rag_system.db"
    
  # Persistence
  auto_save: true
  save_interval: 600  # seconds
  backup:
    enabled: true
    interval: 86400  # daily
    max_backups: 7

# API Configuration
api:
  host: "0.0.0.0"
  port: 8000
  workers: 4
  reload: false
  cors:
    enabled: true
    origins: ["*"]
    methods: ["GET", "POST"]
  
  # Rate Limiting
  rate_limiting:
    enabled: true
    requests_per_minute: 60
    
  # Authentication
  auth:
    enabled: false
    type: "bearer"  # bearer, api_key, oauth2
    
  # WebSocket
  websocket:
    enabled: true
    max_connections: 100
    heartbeat_interval: 30

# Monitoring & Logging
monitoring:
  # Metrics
  metrics:
    enabled: true
    export_interval: 60
    prometheus_port: 9090
    
  # Logging
  logging:
    level: "INFO"
    format: "json"  # json, text
    file: "./logs/rag_system.log"
    max_size: "100MB"
    max_files: 10
    
  # Tracing
  tracing:
    enabled: false
    service_name: "agentic-rag"
    jaeger_endpoint: "http://localhost:14268"
    
  # Health Checks
  health_check:
    enabled: true
    interval: 30
    timeout: 10

# Evaluation Configuration
evaluation:
  # Metrics
  metrics:
    - "f1_score"
    - "exact_match"
    - "bleu"
    - "rouge"
    - "bert_score"
    - "faithfulness"
    - "relevance"
    - "coherence"
    
  # Benchmarks
  benchmarks:
    - "ms_marco"
    - "natural_questions"
    - "hotpotqa"
    - "mmlu"
    - "vqa_v2"
    - "audioset"
    
  # Settings
  batch_size: 16
  num_samples: 1000
  save_results: true
  results_path: "./evaluation_results"

# Experimental Features
experimental:
  # Advanced Retrieval
  dense_passage_retrieval: false
  colbert_retrieval: false
  neural_reranking: false
  
  # Advanced Generation
  constitutional_ai: false
  chain_of_verification: false
  self_consistency: false
  
  # Multimodal
  visual_grounding: false
  audio_visual_sync: false
  multi_hop_reasoning: false
  
  # Memory
  episodic_memory: false
  working_memory_size: 10
  long_term_memory: false

# Development Settings
development:
  debug: false
  verbose: false
  profile: false
  mock_llm: false
  test_mode: false
  
# Production Settings
production:
  ssl_enabled: false
  ssl_cert_path: null
  ssl_key_path: null
  load_balancer: false
  auto_scaling: false
  min_replicas: 1
  max_replicas: 10